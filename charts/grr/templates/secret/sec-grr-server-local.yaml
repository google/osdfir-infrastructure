apiVersion: v1
kind: Secret
metadata:
  name: sec-grr-server-local
  {{- if .Values.grr.namespace }}
  namespace: {{ .Values.grr.namespace }}
  {{- end }}
stringData:
  server.local.yaml: |
    Database.implementation: MysqlDB
    Blobstore.implementation: DbBlobStore
    Mysql.host: {{ .Values.grr.mysqlDb.address }}
    Mysql.port: {{ .Values.grr.mysqlDb.port }}
    Mysql.database: {{ .Values.grr.mysqlDb.name }}
    Mysql.username: {{ .Values.grr.mysqlDb.userName }}
    Mysql.password: {{ .Values.grr.mysqlDb.userPassword }}
    Mysql.flow_processing_threads_max: 20
    Client.server_urls:
    - http://localhost:8080/
    AdminUI.csrf_secret_key: KPK,_0a_xY&DTeiaokEdsH1uXGobNIhfrr67BTSLlPPv64_UE0nyn8QsD6
    AdminUI.url: http://localhost:{{ .Values.grr.admin.listenPort }}
    AdminUI.bind: 0.0.0.0
    AdminUI.use_precompiled_js: true
    API.DefaultRouter: ApiCallRouterWithoutChecks

    Logging.domain: localhost
    Logging.verbose: true
    Logging.engines: file,stderr
    Logging.path: /grr
    Logging.filename: /grr/grr-server.log
    Monitoring.alert_email: grr-monitoring@localhost
    Monitoring.emergency_access_email: grr-emergency@localhost
    Monitoring.http_address: 0.0.0.0
    Monitoring.http_port: {{ .Values.prometheus.metricsPort }}

    Frontend.certificate: "%(/grr/certs/grr-frontend.crt|file)"

    Server.initialized: true
    Server.fleetspeak_enabled: true
    Server.fleetspeak_server: svc-fleetspeak-admin:{{ .Values.fleetspeak.admin.listenPort }}
    Server.fleetspeak_message_listen_address: 0.0.0.0:{{ .Values.grr.frontend.listenPort }}
